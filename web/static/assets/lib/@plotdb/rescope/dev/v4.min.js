(function(){function t(t,n){var e={}.hasOwnProperty;for(var r in n)e.call(n,r)&&(t[r]=n[r]);return t}var n,e,r,i,o;(r=function(t){var r,i,o,c,s=this;return null==t&&(t={}),this.lc=t.context||{},this.id=Math.random().toString(36).substring(2),t.iframe?this.iframe=t.iframe:(this.iframe=r=e.createElement("iframe"),(i=r.style).position="absolute",i.top=0,i.left=0,i.width=0,i.height=0,i.pointerEvents="none",i.opacity=0,r.setAttribute("title","rescope script loader"),r.setAttribute("name","pdb-proxin-"+this.id),r.setAttribute("sandbox","allow-same-origin allow-scripts"),e.body.appendChild(r)),o=Object.fromEntries(Reflect.ownKeys(this.iframe.contentWindow).map(function(t){return[t,!0]})),c={},this._proxy=new Proxy(t.target||n,{get:function(t,n,e){if(null!=s.lc[n])return s.lc[n];if(null!=c[n])return c[n];if(null!=o[n])return"function"==typeof t[n]?c[n]=t[n].bind(t):t[n]},set:function(t,n,e){return o[n]?(t[n]=e,!0):(s.lc[n]=e,!0)}}),this}).prototype=(i=Object.create(Object.prototype),i.proxy=function(){return this._proxy},i.ctx=function(){return this.lc},i),(o=function(t){var n,i;return null==t&&(t={}),this.id=Math.random().toString(36).substring(2),this.iframe=n=e.createElement("iframe"),this._cache={},this.proxy=new r,this.registry(t.registry||"/assets/lib/"),i=n.style,i.position="absolute",i.top=0,i.left=0,i.width=0,i.height=0,i.pointerEvents="none",i.opacity=0,n.setAttribute("title","rescope script loader"),n.setAttribute("name","pdb-rescope-"+this.id),n.setAttribute("sandbox","allow-same-origin allow-scripts"),e.body.appendChild(n),n.contentWindow.document.body.innerHTML=(t.preloads||[]).map(function(t){return'<script type="text/javascript" src="'+t+'"><\/script>'}).join(""),this}).env=function(t){var r;return r=[t,t.document],n=r[0],e=r[1],r},o.prop={legacy:{webkitStorageInfo:!0}},o.id=function(t){return t.id||t.url||t.name+"@"+t.version+"/"+t.path},o._cache={},o.cache=function(n){var e;return"string"==typeof n&&(n={url:n}),n.id||(n.id=o.id(n)),(e=o._cache[n.id])?e:o._cache[n.id]=t({},n)},o.bundle=function(n){if(null==n&&(n={}),!(n=t({},n)).id)return n.id=o.id(n)},o.prototype=(i=Object.create(Object.prototype),i.peekScope=function(){return!1},i.init=function(){return Promise.resolve()},i._url=function(t){var n;return"string"==typeof t?t:(n=t.url)?n:this._reg(t)},i.registry=function(t){return"string"==typeof t?("/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),this._reg=function(t){return function(n){return t+"/"+n.name+"/"+(n.version||"main")+"/"+(n.path||"index.min.js")}}(t)):this._reg=t},i.cache=function(n){var e,r;return"string"==typeof n&&(n={url:n}),n.id||(n.id=o.id(n)),(e=this._cache[n.id])?e:(r=o._cache[n.id])?this._cache[n.id]=r:this._cache[n.id]=t({},n)},i.exports=function(t){var n,e,r,i,o,c,s=[];null==t&&(t={}),n=t.ctx||{},e="string"==typeof t.libs?[t.libs]:t.libs||[],i=(r=[{},this.iframe.contentWindow])[0],o=r[1];for(c in n)i[c]=o[c],o[c]=n[c];this._exports(e,0);for(c in n)s.push(o[c]=i[c]);return s},i._exports=function(t,n){var e,r,i,c,s,u,l,p,a=[];if(null==n&&(n=0),e=t[n]){if(e=this.cache(e),r=[{},e.fprop,this.iframe.contentWindow],i=r[0],c=r[1],s=r[2],c)for(l in c)i[l]=s[l],s[l]=c[l];else{e.fprop=c={},e.prop={},u=Object.fromEntries(Reflect.ownKeys(s).filter(function(t){return!o.prop.legacy[t]}).map(function(t){return[t,!0]}));for(l in u)i[l]=s[l];s.eval(e.code),p=Object.fromEntries(Reflect.ownKeys(s).filter(function(t){return!o.prop.legacy[t]}).map(function(t){return[t,!0]}));for(l in p)s[l]!==i[l]&&"NaN"!==l&&(c[l]=s[l],e.prop[l]=null,e.propIniting=!0)}this._exports(t,n+1);for(l in c)a.push(s[l]=i[l]);return a}},i._wrap=function(t,n){var e,r,i;null==t&&(t={}),null==n&&(n={}),function(){var t=[];for(e in n)t.push(e);return t}().join(","),r=t.prop||{},i="var window, global, globalThis, self, __ret = {}; __win = {};\nwindow = global = globalThis = window = scope;";for(e in r)i+="var "+e+"; __win['"+e+"'] = win['"+e+"']; win['"+e+"'] = undefined;";for(e in n)i+="var "+e+" = window['"+e+"'] = ctx['"+e+"'];";i+=t.code+";";for(e in r)i+="__ret['"+e+"'] = "+e+" || window['"+e+"'] || win['"+e+"'] || this['"+e+"'];\nwin['"+e+"'] = __win['"+e+"'];";return i+="return __ret;",new Function("scope","ctx","win",i)},i.load=function(n,e){var i,o,c,s=this;return n=(Array.isArray(n)?n:[n]).map(function(t){return s.cache(t)}),e=n.px?n.px:n.px=e||new r,i=e.ctx(),o=e.proxy(),c=n.map(function(t){return t.code?Promise.resolve():ld$.fetch(s._url(t),{method:"GET"},{type:"text"}).then(function(n){return t.code=n})}),Promise.all(c).then(function(){return s.exports({libs:n}),n.map(function(n){return n.propIniting&&(n.gen=s._wrap(n,i),n.prop=n.gen(o,i,window),n.propIniting=!1),t(i,n.prop)})}).then(function(){return i})},i.context=function(t,n,e){var r;return"function"!=typeof n&&(n=(r=[e,n])[0],e=r[1]),this.load(t,e).then(function(t){return n(t)})},i),o.env("undefined"!=typeof self&&null!==self?self:globalThis),o.proxin=r,"undefined"!=typeof module&&null!==module?module.exports=o:window&&(window.rescope=o)}).call(this);
