(function(){function t(t,n){var e={}.hasOwnProperty;for(var r in n)e.call(n,r)&&(t[r]=n[r]);return t}var n,e,r;(n=function(t){var n,e,r,i,o=this;return null==t&&(t={}),this.lc=t.context||{},this.id=Math.random().toString(36).substring(2),t.iframe?this.iframe=t.iframe:(this.iframe=n=document.createElement("iframe"),(e=n.style).position="absolute",e.top=0,e.left=0,e.width=0,e.height=0,e.pointerEvents="none",e.opacity=0,n.setAttribute("title","rescope script loader"),n.setAttribute("name","pdb-proxin-"+this.id),n.setAttribute("sandbox","allow-same-origin allow-scripts"),document.body.appendChild(n)),r=Object.fromEntries(Reflect.ownKeys(this.iframe.contentWindow).map(function(t){return[t,!0]})),i={},this._proxy=new Proxy(t.target||window,{get:function(t,n,e){if(null!=o.lc[n])return o.lc[n];if(null!=i[n])return i[n];if(null!=r[n])return"function"==typeof t[n]?i[n]=t[n].bind(t):t[n]},set:function(t,n,e){return r[n]?(t[n]=e,!0):(o.lc[n]=e,!0)}}),this}).prototype=(e=Object.create(Object.prototype),e.proxy=function(){return this._proxy},e.ctx=function(){return this.lc},e),(r=function(t){var e,r;return null==t&&(t={}),this.id=Math.random().toString(36).substring(2),this.iframe=e=document.createElement("iframe"),this._cache={},this.proxy=new n,this.registry(t.registry||"/assets/lib/"),r=e.style,r.position="absolute",r.top=0,r.left=0,r.width=0,r.height=0,r.pointerEvents="none",r.opacity=0,e.setAttribute("title","rescope script loader"),e.setAttribute("name","pdb-rescope-"+this.id),e.setAttribute("sandbox","allow-same-origin allow-scripts"),document.body.appendChild(e),e.contentWindow.document.body.innerHTML=(t.preloads||[]).map(function(t){return'<script type="text/javascript" src="'+t+'"><\/script>'}).join(""),this}).prop={legacy:{webkitStorageInfo:!0}},r.id=function(t){return t.id||t.url||t.name+"@"+t.version+"/"+t.path},r._cache={},r.cache=function(n){var e;return"string"==typeof n&&(n={url:n}),n.id||(n.id=r.id(n)),(e=r._cache[n.id])?e:r._cache[n.id]=t({},n)},r.bundle=function(n){if(null==n&&(n={}),!(n=t({},n)).id)return n.id=r.id(n)},r.prototype=(e=Object.create(Object.prototype),e._url=function(t){var n;return"string"==typeof t?t:(n=t.url)?n:this._reg(t)},e.registry=function(t){return"string"==typeof t?("/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),this._reg=function(t){return function(n){return t+"/"+n.name+"/"+(n.version||"main")+"/"+(n.path||"index.min.js")}}(t)):this._reg=t},e.cache=function(n){var e,i;return"string"==typeof n&&(n={url:n}),n.id||(n.id=r.id(n)),(e=this._cache[n.id])?e:(i=r._cache[n.id])?this._cache[n.id]=i:this._cache[n.id]=t({},n)},e.exports=function(t){var n,e,r,i,o,c,s=[];null==t&&(t={}),n=t.ctx||{},e="string"==typeof t.libs?[t.libs]:t.libs||[],i=(r=[{},this.iframe.contentWindow])[0],o=r[1];for(c in n)i[c]=o[c],o[c]=n[c];this._exports(e,0);for(c in n)s.push(o[c]=i[c]);return s},e._exports=function(t,n){var e,i,o,c,s,u,a,p,l=[];if(null==n&&(n=0),e=t[n]){if(e=this.cache(e),i=[{},e.fprop,this.iframe.contentWindow],o=i[0],c=i[1],s=i[2],c)for(a in c)o[a]=s[a],s[a]=c[a];else{e.fprop=c={},e.prop={},u=Object.fromEntries(Reflect.ownKeys(s).filter(function(t){return!r.prop.legacy[t]}).map(function(t){return[t,!0]}));for(a in u)o[a]=s[a];s.eval(e.code),p=Object.fromEntries(Reflect.ownKeys(s).filter(function(t){return!r.prop.legacy[t]}).map(function(t){return[t,!0]}));for(a in p)s[a]!==o[a]&&"NaN"!==a&&(c[a]=s[a],e.prop[a]=null,e.propIniting=!0)}this._exports(t,n+1);for(a in c)l.push(s[a]=o[a]);return l}},e._wrap=function(t,n){var e,r,i;null==t&&(t={}),null==n&&(n={}),function(){var t=[];for(e in n)t.push(e);return t}().join(","),r=t.prop||{},i="var window, global, globalThis, self, __ret = {};\nwindow = global = globalThis = window = scope;";for(e in r)i+="var "+e+";";for(e in n)i+="var "+e+" = window['"+e+"'] = ctx['"+e+"'];";i+=t.code+";";for(e in r)i+="__ret['"+e+"'] = "+e+" || window['"+e+"'];";return i+="return __ret;",new Function("scope","ctx",i)},e.load=function(n,e){var r,i,o=this;return n=(Array.isArray(n)?n:[n]).map(function(t){return o.cache(t)}),r=(e||this.proxy).ctx(),e=(e||this.proxy).proxy(),i=n.map(function(t){return t.code?Promise.resolve():ld$.fetch(o._url(t),{method:"GET"},{type:"text"}).then(function(n){return t.code=n})}),Promise.all(i).then(function(){return o.exports({libs:n}),n.map(function(n){return n.propIniting&&(n.gen=o._wrap(n,r),n.prop=n.gen(e,r),n.propIniting=!1),t(r,n.prop)})}).then(function(){return r})},e.context=function(t,n,e){return this.load(t,e).then(function(t){return n(t)})},e),"undefined"!=typeof module&&null!==module?module.exports=r:window&&(window.rescope=r)}).call(this);
